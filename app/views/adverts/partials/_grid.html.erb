  <div id="google_map">
    <div id="map_index" style='width: 100%; height: 100%;'></div>
</div>

<!-- GOOGLE MAP -->
<script>
  // Create an array of styles.
    var mapStyle = [
  {
    "featureType": "water",
    "stylers": [
      { "color": "#DCE8FC" }
    ]
  },{
    "featureType": "administrative",
    "elementType": "labels.text.fill",
    "stylers": [
      { "color": "#777777" }
    ]
  },{
    "featureType": "poi.park",
    "stylers": [
      { "color": "#E3ECD5" }
    ]
  },{
    "featureType": "road",
    "elementType": "labels.icon",
    "stylers": [
      { "visibility": "off" }
    ]
  },{
    "featureType": "administrative.locality",
    "elementType": "labels.text.fill",
    "stylers": [
      { "color": "#777777" }
    ]
  },{
    "featureType": "administrative.country",
    "elementType": "geometry.stroke",
    "stylers": [
      { "color": "#a1a1a1" }
    ]
  },{
    "featureType": "road.highway",
    "elementType": "geometry.fill",
    "stylers": [
      { "color": "#ffffff" }
    ]
  },{
    "featureType": "road.highway",
    "elementType": "geometry.stroke"
  }
];

  handler = Gmaps.build('Google');
  handler.buildMap({ provider: {streetViewControl: false, mapTypeControl: false, styles: mapStyle }, internal: {id: 'map_index'}}, function(){

    markers = handler.addMarkers(<%=raw @hash.to_json %>);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
    handler.getMap().setZoom(6);    // set the default zoom of the map
  });
</script>

  <div class="user_grid_wrapper">
    <div class="user_grid_container">
      <div class="frame">
        <% @adverts.each do |advert| %>
            <div class="bit-3">
              <div class="user_ad">
                <% if advert.photos.empty? or advert.photos.nil?%>
                  <%= link_to advert_path(advert), data: { no_turbolink: true } do %>
                      <%= image_tag "paper_plane.png" %>
                    <% end %>
                  <% else %>
                    <%= link_to advert_path(advert), data: { no_turbolink: true } do %>
                      <% advert.photos.first(1).each do |photo| %>
                          <%= image_tag photo.image_url(:advert_image) %>
                      <% end %>
                    <% end %>
                  <% end %>

                  <% unless advert.price.nil? %>
                      <div class="user_ad_price">
                          <%= number_to_currency(advert.price, precision: 0, unit: "") %> <%= advert.currency %>
                      </div>
                  <% end %>

                  <div class="user_ad_footer">
                    <div class="user_ad_avatar">
                        <%= link_to user_path(advert.user) do %>
                          <% if advert.user.avatar.blank? or advert.user.avatar.nil? %>
                              <%= image_tag "avatar.png" %>
                          <% else %>
                              <%= image_tag advert.user.avatar_url(:avatar_small) %>
                          <% end %>
                        <% end %>
                    </div>

                    <%= link_to advert_path(advert), data: { no_turbolink: true } do %>
                        <div class="user_ad_make">
                          <%= advert.make %>

                          <div class="user_ad_model">
                              <%= advert.model %>
                          </div>
                        </div>
                    <% end %>
                  </div>
                </div>
            </div>
        <% end %>
      </div>
        <div class="pagination">
          <%= will_paginate @adverts, :previous_label => 'Previous', :next_label => 'Next', :page_links => false %>
      </div>
    </div>
  </div>


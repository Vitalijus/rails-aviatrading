<% page_title_helper "Aircraft For Sale Worldwide" %>

<% meta_description_helper "Search, buy and sell aircraft worldwide at aviatrading.com. You can find new and used aircraft, airplanes and helicopters, leave your message, locate airctaft and many more." %>

<div id="google_map_index">
  <div id="map_index" style='width: 100%; height: 100%;'></div>
</div>

<!-- GOOGLE MAP -->
<script>
  // Create an array of styles.
    var mapStyle = [
  {
    "featureType": "water",
    "stylers": [
      { "color": "#DCE8FC" }
    ]
  },{
    "featureType": "administrative",
    "elementType": "labels.text.fill",
    "stylers": [
      { "color": "#777777" }
    ]
  },{
    "featureType": "poi.park",
    "stylers": [
      { "color": "#E3ECD5" }
    ]
  },{
    "featureType": "road",
    "elementType": "labels.icon",
    "stylers": [
      { "visibility": "off" }
    ]
  },{
    "featureType": "administrative.locality",
    "elementType": "labels.text.fill",
    "stylers": [
      { "color": "#777777" }
    ]
  },{
    "featureType": "administrative.country",
    "elementType": "geometry.stroke",
    "stylers": [
      { "color": "#a1a1a1" }
    ]
  },{
    "featureType": "road.highway",
    "elementType": "geometry.fill",
    "stylers": [
      { "color": "#ffffff" }
    ]
  },{
    "featureType": "road.highway",
    "elementType": "geometry.stroke"
  }
];

  handler = Gmaps.build('Google');
  handler.buildMap({ provider: {streetViewControl: false, mapTypeControl: false, styles: mapStyle }, internal: {id: 'map_index'}}, function(){

    markers = handler.addMarkers(<%=raw @hash.to_json %>);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
    handler.getMap().setZoom(6);    // set the default zoom of the map
  });
</script>

  <div class="user_grid_wrapper">
    <div class="user_grid_container">

      <% if @adverts.count == 0 %>
        <div id="record_not_found">
          Record not found
        </div>
      <% end %>

      <div class="frame">
        <% @adverts.each do |advert| %>
            <div class="bit-3">
              <div class="user_ad">
                <% if advert.photos.empty? or advert.photos.nil?%>
                  <%= link_to advert_path(advert), data: { no_turbolink: true } do %>
                      <%= image_tag "paper-plane.png", alt: "Paper plane" %>
                    <% end %>
                  <% else %>
                    <%= link_to advert_path(advert), data: { no_turbolink: true } do %>
                      <% advert.photos.first(1).each do |photo| %>
                          <%= image_tag photo.image_url(:advert_image), alt: "#{advert.year} #{advert.make} #{advert.model} for sale" %>
                      <% end %>
                    <% end %>
                  <% end %>

                  <div class="user_ad_footer">
                    <div class="user_ad_avatar">
                        <%= link_to user_path(advert.user) do %>
                          <% if advert.user.avatar.blank? or advert.user.avatar.nil? %>
                              <%= image_tag "avatar.png", alt: "Seller profile image" %>
                          <% else %>
                              <%= image_tag advert.user.avatar_url(:avatar_small), alt: "Seller profile image" %>
                          <% end %>
                        <% end %>
                    </div>

                    <%= link_to advert_path(advert), data: { no_turbolink: true } do %>
                        <div class="user_ad_make">
                          <%= advert.make %>

                          <div class="user_ad_model">
                              <%= truncate(advert.model, :length => 25, :omission => '...') %>
                          </div>
                        </div>
                    <% end %>
                  </div>

                  <div class="user_ad_price">
                    <ul>
                      <% if advert.price_options.nil? or advert.price_options.blank? %>
                        <li>
                          <%= number_to_currency(advert.price, precision: 0, unit: "") %> <%= currency_to_symbol_helper(advert.currency) %>
                        </li>
                      <% else %>
                        <li>
                          <%= advert.price_options %>
                        </li>
                      <% end %>

                      <li class="user_ad_price_location">
                        <%= advert.city %>, <%= advert.country %>
                      </li>
                    </ul>
                  </div>
                </div>
            </div>
        <% end %>
      </div>
        <div class="pagination">
          <%= will_paginate @adverts, :previous_label => 'Previous', :next_label => 'Next', :page_links => false %>
      </div>
    </div>
  </div>

